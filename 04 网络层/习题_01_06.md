#### P1 在本题中，考虑虚电路网络和数据报网络的某些优缺点。
#### a. 假设路由器遇到了可能经常会引起它无法正常运转的情况。提出理由说明是虚电路体系结构还是数据报体系结构更好？为什么？
#### b. 对于源和目的结点间传输流量的排他性使用，假设该源和目的结点要求，在沿源到目的地的路径上的所有路由器总能提供固定的容量。提出理由说明是虚电路体系结构还是数据报体系结构更好？为什么？
#### c. 假设网络中的链路和路由器从不出故障，并且所有源/目的地对之间所使用的路径保持不变。在这种情况下，虚电路或数据报体系结构哪个控制流量开销会更多,为什么？

  * a.
    * 数据报网络更好，即使一个结点发生故障，那么 RIP 会通告该路由的不可达信息，OSPF 也会作出如此通告，那么路由选择算法必定不会选择经过该故障路由器的路径。而虚电路网络在初期连接建立阶段已经确定了唯一的路径，如果其中某个路由器发生故障，那么该连接将失效。
  * b.
    * 源和目的结点要求，所有源到目的路径上的路由器总能提供固定容量，那么这需要路由器知道流量的特征，对于虚电路网络，在连接建立阶段的握手报文在每一台路由器上都进行了约定协商，因此对于虚电路体系结构，这是可能的。比如 ATM 的 CBR
  * c.
    * 数据报体系的流量开销更多，因为每个分组都携带了很多字节的头部控制信息(比如 IPv4 20 字节，IPv6 40 字节)，从而决定路由的方式。而虚电路体系结构在连接建立阶段就建立了一条电路，并且始终不变，因此分组只需要一个轻量级的头部就可以。

#### P2 考虑一个虚电路网络。假定其 VC 号是一个 8 比特字段。
#### a. 链路能够承载的虚电路的最大数量是多少？
#### b. 假定某中心结点在连接建立时确定了路径和 VC 号。假定沿着某虚电路的路径在每段链路使用相同的 VC 号。描述在连接建立时中心结点如何确定 VC 号。进行中虚电路比在 (a) 中确定的最大值要少，也没有相同的未用 VC 号，这种情况可能出现吗？
#### c. 假定沿着某条虚电路的路径允许不同的 VC 号。在连接建立期间，在端到端路径确定以后，描述链路如何以分散方式而不依赖中心结点选择它们的 VC 号并配置它们的转发表。

 * a.
   * 2^8 - 1 = 255 所以最大数量为 0 ~ 255 即 256 个。
  
 * b.  // TODO
 * c.  // TODO

#### P3 在虚电路网络中的基本转发表具有 4 列。在这些列中的值的含义是什么？在数据报网络中的基本转发表有两列。在这些列中的值的含义是什么？

 * 输入链路端口号，入 VC 号，输出链路端口号，出 VC 号。
 * 目的子网前缀，输出链路端口号。

#### P4 考虑下列网络。
#### a. 假定网络是一个数据报网络。写出路由器 A 中的转发表，从而满足所有指向主机 H3 的流量都通过接口 3 转发。
#### b. 假定网络是一个数据报网络。你能写出路由器 A 中的转发表从而满足其中所有从 H1 指向主机 H3 的流量通过接口 3 转发，而所有从 H2 指向主机 H3 的流量通过接口 4 转发。（提示：这是一个技巧问题）
#### c. 现在假定网络是虚电路网络，在 H1 和 H3 之间有一个进行中的呼叫，H2 和 H3 之间有另一个进行中的呼叫。写出路由器 A 中的转发表，其中所有从 H1 指向主机 H3 的流量通过接口 3 转发，而所有从 H2 指向主机 H3 的流量通过接口 4 转发。
#### d. 假设场景与 (c) 中相同，写出在结点 B, C 和 D 中的转发表。
  ![](https://github.com/YangXiaoHei/Networking/blob/master/04%20网络层/images/p4.png)
  
  * a.
  
	|目的子网前缀 | 出端口号 |
	|:---:|:---:|
	|H3|3|
	
  * b.
    * 不能，因为转发表是根据目的地来区分的，而不是源地址。
    
  * c.
  
	   |入端口号|入 VC 号|出端口号|出 VC 号|
	   |:---:|:---:|:---:|:----:|
	   |1|22|3|44|
	   |2|23|4|45|

   * 当然 VC 号也可以相同
      
	   |入端口号|入 VC 号|出端口号|出 VC 号|
	   |:---:|:---:|:---:|:----:|
	   |1|22|3|22|
	   |2|33|4|33|

  * d.
    * Router A
    
      |入端口号|入 VC 号|出端口号|出 VC 号|
	   |:---:|:---:|:---:|:----:|
	   |1|22|3|44|
	   |2|23|4|45|
    
    * Router B

      |入端口号|入 VC 号|出端口号|出 VC 号|
	   |:---:|:---:|:---:|:----:|
	  |1|44|2|55|
    
    * Router C

	   |入端口号|入 VC 号|出端口号|出 VC 号|
	   |:---:|:---:|:---:|:----:|
	   |1|45|2|66|
    
    * Router D
	
	   |入端口号|入 VC 号|出端口号|出 VC 号|
	   |:---:|:---:|:---:|:----:|
	   |1|55|3|66|
	   |2|66|3|55|

#### P5 考虑一个用 2 比特字段表示 VC 号的虚电路网络。假定该网络要通过 4 条链路 (链路 A、链路 B、链路 C 和链路 D) 建立一条虚电路。假定这些链路中的每条当前都要承载两条其他的虚电路，这些其他虚电路的 VC 号如下:

|链路 A|链路 B| 链路 C| 链路 D|
|:---:|:---:|:---:|:---:|
|00|01|10|11|
|01|10|11|00|

#### 在回答下列问题时，记住每个现有的虚电路可能通过这 4 条链路之一。
#### a. 如果每条虚电路要求沿着其路径使用相同的 VC 号，能为该新的虚电路分配什么样的 VC 号？
#### b. 如果每条虚电路沿着其路径允许不同的链路使用不同的 VC 号 (因此转发表必须执行 VC 号转换)，能够使用 4 个 VC 号的多少种不同的组合 (一种组合用于这 4 条链路之一)？

![](https://github.com/YangXiaoHei/Networking/blob/master/04%20网络层/images/p5.png)
 
  * a.
    * A 已经用了 0 和 1，那么通过 A 只能用 2 或 3，发现 B 用了 2 ，那么只能用 3，然后发现 C 用了 3，那么就说明已经无法为新的虚电路分配 VC 号了。 
    
  * b.
    * A 还可以用 2 3，B 还可以用 0 3，C 还可以用 0 1， D 还可以用 1 2，所以就是 `2 x 2 x 2 x 2 = 16` 种 

#### P6 在本书中我们使用术语面向连接来描述运输层服务，使用术语连接服务描述网络层服务。在术语中为何有这种微妙的差异？

  * 因为网络层的连接服务中，每个路由器都维护了连接的状态。而在运输层的 TCP 协议中，是构建在路由器不维护连接状态的基础上，由两个端系统维护了连接的状态，因此是面向连接的。

