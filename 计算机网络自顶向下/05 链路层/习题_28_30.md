#### P28 考虑图 5-25 中的单个交换机 VLAN，假定一台外部路由器与交换机端口 1 相连。为 EE 和 CS 的主机和路由器接口分配 IP 地址。跟踪从 EE 主机向 CS 主机传送一个数据报时网络层和链路层所采取的步骤。

![](https://github.com/YangXiaoHei/Networking/blob/master/master/计算机网络自顶向下/05%20链路层/images/p28.png)

  * EE
    * 从左到右
    * 111.111.1.1
    * 111.111.1.2
    * 111.111.1.3
    
  * CS
    * 从左到右 
    * 111.111.2.1
    * 111.111.2.2
    * 111.111.2.3

  * 当 EE 的主机 A 111.111.1.1 向 CS 的主机 B 111.111.2.1 发送一个数据报时，所采取的步骤如下：
  * 因为有一台外部路由器与交换机端口 1 相连，因此与端口 1 相连的该路由器的接口被配置为是作用于两个网段的 111.111.1/24 和 111.111.2/24
  * 主机 A 的适配器设置该帧信息如下
    * 源 IP: 111.111.1.1
    * 目的 IP : 111.111.2.1
    * 源 MAC : AA-AA-AA-AA-AA-AA
    * 目的 MAC : 路由器接口适配器的 MAC 地址
    * 标签 : VLAN 11
  * 交换机将该帧转发给路由器，根据它的交换表。当路由器收到这个向自己寻址的帧后，它提取出网络层 IP 数据报，知道要向 111.111.2/24 网段转发，因此选择端口，然后填写 B 的 MAC 地址和 VLAN 标签
    * 源 IP: 111.111.1.1
    * 目的 IP : 111.111.2.1
    * 源 MAC : 路由器接口适配器的 MAC 地址
    * 目的 MAC : BB-BB-BB-BB-BB-BB
    * 标签 : VLAN 12
  * 当主机 B 收到该帧后，发现是向自己寻址的帧，然后删除标签。

#### P29 考虑显示在图 5-29 中的 MPLS 网络，假定路由器 R5 和 R6 现在是 MPLS  使能的。假定我们要执行流量工程，使从 R6 发往 A 的分组要经 R6-R4-R3-R1 交换到 A，从 R5 发向 A 的分组要经 R5-R4-R2-R1 交换。给出 R5 和 R6 中的 MPLS 表以及在 R4 中修改的表，使得这些成为可能。

![](https://github.com/YangXiaoHei/Networking/blob/master/05%20链路层/images/p29.png)

* R6
 
|入标签|出标签|目的地|出接口|
|:---:|:---:|:---:|:----:|
||20|A|0|
|...|...|...|...|

* R4

|入标签|出标签|目的地|出接口|
|:---:|:---:|:---:|:----:|
|20|10|A|0|
|30|12|D|0|
|40|8|A|1|

* R5

|入标签|出标签|目的地|出接口|
|:---:|:---:|:---:|:----:|
||40|A|0|
|...|...|...|...|


#### P30 再次考虑上一个习题中相同的场景，但假定从 R6 发往 D 的分组经 R6-R4-R3 交换，而从 R5 发往 D 的分组经 R4-R2-R1-R3 交换。说明为使这些成为可能在所有路由器中的 MPLS 表。

* R6
 
|入标签|出标签|目的地|出接口|
|:---:|:---:|:---:|:----:|
||20|D|0|

* R5

|入标签|出标签|目的地|出接口|
|:---:|:---:|:---:|:----:|
||30|D|0|


* R4

|入标签|出标签|目的地|出接口|
|:---:|:---:|:---:|:----:|
|20|10|D|0|
|30|12|D|1|

* R3

|入标签|出标签|目的地|出接口|
|:---:|:---:|:---:|:----:|
|10|12|D|0|

* R2

|入标签|出标签|目的地|出接口|
|:---:|:---:|:---:|:----:|
|12|15|D|0|

* R1

|入标签|出标签|目的地|出接口|
|:---:|:---:|:---:|:----:|
|15|10|D|0|




